<!DOCTYPE html>
<html lang="en" dir="ltr">
	<head>
		<meta name="robots" content="noindex">
		<meta charset="utf-8">
		<title>{title}</title>
		<link rel="stylesheet" href="/css/main.css">
	</head>
	<body>
		<div class="breadcrumbs_div">
			
	<ul class="breadcrumb">
		<li><a href="/">Home</a></li>
	<li><a href="/projects">Projects</a></li>
	<li><a href="/projects/airplane_4">Fixed&nbspWing&nbspDrone</a></li>

	</ul>
	
		</div>
		<article>
			<h1 id="airplane-40">Airplane 4.0</h1>
<p>... incomplete article ...</p>
<p>This is a project I'd been dying to work on for several years but couldn't find the time for it. I've made a similar drone before, but with this project I'm going much further.</p>
<p>This drone incorporates 2 way communication via the nRF24L01P long range transceiver module which serves as the interface between a Beagle Bone Blue and a Raspberry Pi (see architecture for more).</p>
<h2 id="1-scope">1 - Scope</h2>
<h3 id="build-objectives">Build Objectives</h3>
<p>Build an autonomous fixed wing drone with software and hardware extensibility in mind.</p>
<h3 id="learning-objectives-maybe-dont">Learning Objectives - maybe dont?</h3>
<ul>
<li>Application of Probability &amp; Statistics<ul>
<li>Kalman Filter</li>
</ul>
</li>
<li>Real time system<ul>
<li>Data flow control</li>
<li>Deterministic computation</li>
</ul>
</li>
<li>Project planning<ul>
<li>Perfection vs timing</li>
</ul>
</li>
<li>Hardware characterization
    -</li>
</ul>
<h3 id="deliverables">Deliverables</h3>
<ul class="checklist">
<li><input type="checkbox" disabled> Project Plan</li>
<li><input type="checkbox" disabled> System Architecture</li>
<li><input type="checkbox" disabled> Out-of-System Integrations...</li>
<li><input type="checkbox" disabled> ???</li>
<li><input type="checkbox" disabled> ???</li>
<li><input type="checkbox" disabled> profit</li>
</ul>
<h3 id="features-specification">Features / Specification</h3>
<ul>
<li>2-way Radio<ul>
<li>Hardware: nRF24L01P</li>
<li>Uplink: Control<ul>
<li>Mission planning</li>
<li>Re-routing</li>
</ul>
</li>
<li>Downlink: Telemetry<ul>
<li>Raw &amp; processed sensor data</li>
<li>Actuator outputs</li>
</ul>
</li>
</ul>
</li>
<li>1-way Radio<ul>
<li>Hardware: Generic RC controller</li>
<li>Uplink: Control<ul>
<li>Control surface values</li>
<li>Degree of autonomy</li>
</ul>
</li>
</ul>
</li>
<li>Sensing &amp; Estimation<ul>
<li>GPS</li>
<li>IMU</li>
<li>Barometer</li>
</ul>
</li>
<li>Computation<ul>
<li>HLC (High level controller)<ul>
<li>Hardware: <a target="_blank" href="https://beagleboard.org/blue">Beagle Bone Blue</a></li>
<li>Software: Debian Linux</li>
<li>Functions:<ul>
<li>Telemetry connection</li>
<li>Sensor fusion</li>
</ul>
</li>
</ul>
</li>
<li>LLC (Low level controller)<ul>
<li>Hardware:</li>
<li>Software:</li>
</ul>
</li>
<li>CMux (Control Multiplexer)<ul>
<li>Hardware: AVR ATMEGA 328p</li>
<li>Software: Assembly code</li>
</ul>
</li>
<li>GC (Ground controller)<ul>
<li>Hardware: Raspberry Pi</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="initial-constraints">Initial Constraints</h3>
<p>These constraints help by either defining device parameters that don't really matter (so that time doesn't have to be spent on something pointless), or by disallowing me from over optimizing.</p>
<ul>
<li>Aircraft<ul>
<li>Flight time: 60 min - 120 min</li>
</ul>
</li>
<li>Protocols<ul>
<li>Minimum of 8 bits for data<ul>
<li>Can use one single bit for flags, but that whole byte must be used for related flags.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="initial-assumptions">Initial Assumptions</h3>
<ul>
<li>Windspeed ≈ 0</li>
</ul>
<h3 id="exclusions">Exclusions</h3>
<ul>
<li>Air speed indicator (pitot tube)</li>
</ul>
<h3 id="technology">Technology</h3>
<ol>
<li>2D Partial Autonomy
    1.</li>
</ol>
<h2 id="2-high-level-design-subsystem-overview">2 - High Level Design &amp; Subsystem Overview</h2>
<h3 id="flight-system">Flight System</h3>
<ul>
<li>Mux<ul>
<li>Self determined</li>
<li>Uses the RC when<ul>
<li>BBB data not exactly</li>
</ul>
</li>
</ul>
</li>
<li>Beagle Bone Blue</li>
<li>nRF24L01P TRX</li>
</ul>
<h3 id="ground-system">Ground System</h3>
<h3 id="airplane-design">Airplane Design</h3>
<h2 id="-foam-glider">- Foam glider</h2>
<h3 id="naming-scheme">Naming Scheme</h3>
<h2 id="-systems">- Systems</h2>
<p>-</p>
<h2 id="3-low-level-design">3 - Low Level Design</h2>
<ul>
<li>Remora (Radio Subsystem)<ul>
<li>Data packet format / Telemetry format</li>
<li>CRC</li>
<li>Layer</li>
</ul>
</li>
</ul>
<h2 id="3-individual-module-testing">3 - Individual Module Testing</h2>
<h3 id="considerations">Considerations (?)</h3>
<h2 id="4-integration">4 - Integration</h2>
<h2 id="5-data-collection-system-characterization">5 - Data Collection &amp; System Characterization</h2>
<h2 id="6-flight-software">6 - Flight Software</h2>
<h3 id="features">Features</h3>
<ul>
<li>Pattern hold</li>
<li>Emergency return to base<ul>
<li>When lost signal, completed other waypoints, low battery</li>
<li>Home is a configurable point</li>
</ul>
</li>
</ul>
<h3 id="considerations_1">Considerations</h3>
<ul>
<li>Fault tolerance</li>
</ul>
<h3 id="components">Components</h3>
<ul>
<li>Radio daemon<ul>
<li>SPI library</li>
<li>Check if transmissions</li>
</ul>
</li>
<li>Orientation processor (rename)<ul>
<li>It's the thing that says what direction down is like AOA, bank angle n stuff</li>
</ul>
</li>
<li>IMU processor thing (rename)<ul>
<li>Also simultaneously write all magnetometer values to a buffer accessible to other stuff</li>
<li>PRU</li>
<li>Can change complementary filter parameters mid flight</li>
</ul>
</li>
<li>GPS reader<ul>
<li>Node event based</li>
</ul>
</li>
<li>GPS dead reckoning<ul>
<li>Position = Prev velocity vector * time + prev location + ∆ from IMU</li>
</ul>
</li>
<li>Magnetometer normalization</li>
<li>Positional fusion node thing (rename)<ul>
<li>Kalman filter</li>
<li>Bearing = Magnetometer ∧ GPS dead reckoning</li>
<li>Or idk, i was tired when I wrote some of this. Maybe it doesn't make sense</li>
<li>Maybe analyze drift</li>
</ul>
</li>
<li>Watchdog(s)</li>
<li>sldfjhasf<ul>
<li>Closed loop controller for position maintaining</li>
</ul>
</li>
</ul>
<h2 id="7-ground-control-software">7 - Ground Control Software</h2>
<h3 id="mvp-features">MVP Features</h3>
<ul>
<li>Mission planning</li>
</ul>
<h3 id="mvp-architecture">MVP Architecture</h3>
<h2 id="8-building-the-airplane">8 - Building the Airplane</h2>
<ul>
<li>Built the wing. Now that the wing is built, i feel lit could be too heavy. Will try to see if it flies, if not, I have extra foam and can make another</li>
<li>Not sure if I should put landing gear with wheels, without wheels, or none to limit drag.</li>
</ul>
<h2 id="unsorted-notes">Unsorted Notes</h2>
<ul>
<li>Designing control signal mux<ul>
<li>Interface between actuators &amp; 2 input sources</li>
<li>Must be highly fault tolerant and deterministic</li>
<li>Using simpler chip because<ul>
<li>Engineering exercise</li>
<li>Easier to deal with</li>
</ul>
</li>
<li>Override channels can be selected by BBB</li>
<li>Proportion of override selectable by knob</li>
<li>4 Channel control from</li>
</ul>
</li>
<li>ATMEGA328P Interrupts<ul>
<li>https://thewanderingengineer.com/2014/08/11/arduino-pin-change-interrupts/</li>
</ul>
</li>
<li>Watchdog?</li>
<li>Data Flow Control<ul>
<li>https://tldp.org/HOWTO/Serial-HOWTO-4.html</li>
</ul>
</li>
<li>
<p>Initially, autonomous features restricted</p>
<ul>
<li>will only control rudder</li>
</ul>
</li>
<li>
<p>BBB stuff</p>
<ul>
<li>Have a software controller on this that can switch on and off programs or change parameters in real time during flight<ul>
<li>This may look like ssh over LoRa... ok this sounds like a great idea actually</li>
<li>I should just make some kind of a tunnel over the radios</li>
<li>Components (fill in each of these once you figure out what tech needs what</li>
<li>https://en.wikipedia.org/wiki/Low-power_wide-area_network</li>
</ul>
</li>
<li>Stuff you can input to the BBB<ul>
<li>Restart programs<ul>
<li>Estimation</li>
<li>Sensing</li>
</ul>
</li>
<li>Update profiles<ul>
<li>Like where the lpf ends and hpf begins for IMU complementary filter</li>
</ul>
</li>
</ul>
</li>
<li>IMU<ul>
<li>MPU-9250</li>
<li>Links<ul>
<li>https://forum.arduino.cc/t/low-pass-filter-for-accelerometer-high-pass-for-gyroscope/668130/3</li>
<li>https://d1.amobbs.com/bbs_upload782111/files_44/ourdev_665531S2JZG6.pdf</li>
<li>https://learn.sparkfun.com/tutorials/9dof-razor-imu-m0-hookup-guide/using-the-mpu-9250-dmp-arduino-library</li>
</ul>
</li>
</ul>
</li>
<li>Links<ul>
<li>https://ardupilot.org/plane/docs/common-beagle-bone-blue.html</li>
<li>https://github.com/klekkala/bb_blue_api</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="imu">IMU</h3>
<ul>
<li>Links</li>
<li>Telemetry packet data - 128 bytes reserved - 10 Hz - 10,240 bps<ul>
<li>Power<ul>
<li>Voltage<ul>
<li>Battery - 1 byte</li>
<li>Electronics 5v rail - 1 byte</li>
</ul>
</li>
<li>Current<ul>
<li>Battery - 1 byte</li>
<li>Throttle - 1 byte</li>
<li>Servos - 1 byte</li>
</ul>
</li>
</ul>
</li>
<li>Actuator<ul>
<li>Throttle - 1 byte</li>
<li>Servos - 6 bytes</li>
</ul>
</li>
<li>Sensor<ul>
<li>GPS - 6 bytes</li>
<li>IMU - 6 bytes</li>
<li>Baro - 2 bytes</li>
</ul>
</li>
<li>Radio<ul>
<li>Received power - 1 byte</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Radio stuff
- Using 256 Kbps for the highest reliability</p>
<p>Encoding method 1
- Use signed int where b0 is at center of range and you add or subtract as needed</p>
<p>Kalman filter notes
- https://web.mit.edu/kirtley/kirtley/binlustuff/literature/control/Kalman%20filter.pdf
- https://www.youtube.com/watch?v=E0lnf9k8Neo</p>
		</article>

		<p class="buildwith">
			Website built with <a href="/projects/site_builder/">Static&nbspSite&nbspGenerator</a>. A static website generator I wrote in Python.
		</p>
	</body>
</html>
